# Part 1 : 統計学の基本

## Chapter 1. 統計学

### 1. 統計学の目的①：手持ちのデータの記述

- 手持ちのデータを整理、要約することを目的とした統計学のジャンル
- 記述統計という

### 2. 統計学の目的①：未知のデータの予測・推測

- 未知のデータを予測・推測することを目的とした統計学のジャンル
- 推測統計という

### 3. 【用語】標本と母集団

- 標本：手元にあるデータ
  - つまり、記述統計とは標本を整理、要約する学問ジャンル
- 母集団：未知のデータを含んだ全てのデータ
  - つまり、推測統計とは母集団を予測、推測する学問ジャンル

### 4. 第二章以降の進め方（SKIP）

## Chapter 2. 標本が得られるプロセス

### 1. 【用語】確率変数

- 確率的な法則に従って変化する値を確率変数と呼ぶ

### 2. 湖と釣りの例

- 湖
  - 1種類の魚しかいない
  - 他の川と繋がってない
  - 釣った魚は湖に返す
  - 魚はケガをしない
  - 魚の釣れやすさに違いはない
- 湖から魚を一尾釣る：サンプリング
- 一尾の魚：標本
- 湖の中の全ての魚：母集団

### 3. 母集団から標本が得られるプロセス

- 湖に存在する全ての魚は分かっている
  - 長さ2㎝：１尾
  - 長さ3㎝：１尾
  - 長さ4㎝：１尾
  - 長さ5㎝：１尾
  - 長さ6㎝：１尾
- 一回のサンプリングで釣れる魚は何センチか？という問いの答え
  - 「2cmが20%、3㎝が20%、……」という回答になる
  - 釣れた魚の長さを標本としたとき
  - 標本は確率変数であると言える

### 4. 【用語】実現値

- 確率変数における具体的な値のこと
- 「実現値」と呼ぶ理由は
  - （手に入る可能性はあったのに）手に入らなかったデータがあることをより明確にするため

### 5. 【用語】サンプリング

- あるいは、標本抽出とも

### 6. 【用語】単純ランダムサンプリング

- 母集団の1つ1つの要素が **無作為に** 選ばれる選び方
- 単に、ランダムサンプリングとも

### 7. 【用語】サンプルサイズ

- 手持ちのデータの個数、標本の大きさ
- 1度に2尾標本抽出するなら、サンプルサイズは2
- サンプルサイズは、大きい、小さい、と表現する

### 8. 【用語】全数調査・標本調査

- 母集団全体を調べる調査を全数調査という
- 母集団の一部のみを調べる調査を標本調査という
- 我々は、基本的に、標本調査しかできない

## Chapter 3. 標本が得られるプロセスの抽象化

### 1. 【表記】確率

- 確率はPと表記する
- 前章の「湖で2センチの魚が釣れる確率が20%」を表現するときは
  - P(1.5≦体調<2.5) = 20% or 1/5
  - と表記する

### 2. 【用語】確率分布

- 確率変数とそれに付与された確率との対応を表したもの
- 単に分布ともいう
- もう少し具体的にいうと、
  - (x, y) = (確率変数, 確率) というタプルのリストと思えば良い
  - ビジュアライズする時は、テーブルでもいいし、散布図でもいい
  - 確率分布というのは、グラフのことではなく、そういうデータのこと
  - という理解をしておく
  - 割と、分からなくなる

### 3. 【用語】確率分布に従う

- あるデータが確率分布と対応しているとき「確率分布に従う」という

### 4. 【用語】母集団分布

- 母集団が従う確率分布

### 5. 標本から得られるプロセスとしての母集団分布

- ある母集団から単純ランダムサンプリングにより標本を1つ得る行為
-     ||
- 母集団分布に従う確率変数を1つ取得する行為
- …
- ……とみなそう

### 6. 無限母集団の解釈と母集団分布

skip

### 7. まとめ：標本が得られるプロセス

skip

### 8. 【補足】壺のモデル

- 壺から球を取り出すモデル
- 湖の釣りは、壺のモデル

## Chapter 4. 記述統計の基礎

### 1. 【用語】数値型の変数

- 定量的な数値として得られるものを数値型変数という
- 量的なデータともいう

### 2. 【用語】離散型の変数・連続型の変数

- 数値型の変数は２種類
  - 離散型
  - 連続型

### 3. 【用語】カテゴリ型の変数

- 定量的な数値で表されないものをカテゴリ型の変数という
- 名義尺度
  - 「メダカ」「コイ」「フナ」
- 順序尺度
  - 順序関係を持つカテゴリ変数
  - 「大」「中」「小」
  - 「開始」「途中」「終了」
  - 言い換えるなら、「量的ではあるが定量的ではない」という表現がしっくりきそう

### 4. 【用語】階級・階級値

- ヒストグラムのビンのイメージ
- ある範囲でデータを区切り、その範囲内の代表値でもって、その階級の数とする

### 5. 【用語】度数・度数分布・相対度数

- 度数とは
  - データが現れた（実現した）回数、頻度
- 度数分布
  - 階級に対応する度数の一覧
  - 各階級内の実現値の頻度を総計して、その階級の度数とする
  - という処理を全階級に対して行った結果得られる分布
- 相対度数
  - 全実現値の数を1とした時の度数
  - 2000匹の猫を調査、オス1000匹、メス1000匹の場合
  - 相対度数は、オス1/2、メス1/2

### 6. 【用語】累積度数・累積相対度数

- 累積度数
  - 階級を小さいものから順番に並べて、度数の累積値をとったもの
  - 最後は全データ数になる
- 累積相対度数
  - 階級を小さいものから順番に並べて、相対度数の累積値をとったもの
  - 最後は1になる

### 7. 【用語】ヒストグラム

- 度数分布を図示したもの
- 横軸に階級、縦軸に度数を置いたグラフ

### 8. 【用語】統計量

- データを集計した値のこと
- 標本の特徴を見る方法は二つ
  - 図示する方法
  - 統計量を計算する方法

### 9. 【用語】平均値

skip

### 10. 【用語】期待値

- 「まだ手に入れてない未知のデータであっても適用できる平均値」と言える
- 標本を対象とした場合
  - 平均値と期待値が一致する（期待値の定義上）
  - 故に、記述統計に絞った教科書では平均値と期待値が同じと表現される傾向がある
- 例
  - 平均値：標本の合計値 / 標本数
  - 期待値：(確率 * その時の値)の合計値
  - 標本を対象とした場合、たまたま上記の値が一致する

### 11. 【用語】分散

- 「データが平均値（期待値）とどれだけ離れているか」を表した指標

### 12. 【補足】平均と分散とデータの範囲

skip


## Chapter 5. 母集団分布の推定

### 1. 母集団分布と母集団の相対度数分布

- 母集団分布を得る際には、「確率質量関数」「確率密度関数」を利用すれば即座に計算できる
- ここでは、あえて遠回りすることで理解を深める
- やり方は「母集団の中身を全数調査して、相対度数分布を求める」
- 湖と魚の例では、「どの魚の釣れやすさも同一である」という前提がある為
- 母集団の相対度数分布が分かれば、それがそのまま確率となる
- <font color=red>★しかし、母集団の中身が完全に分かってないといけない</font>
- <font color=red>★ここから、「一部の標本から母集団分布を推定する」作業に入っていく</font>

### 2. もう少し現実的な、湖と釣りの例

- 湖の中には無数の魚（1種類）がいて、全数調査は不可能
- 釣りをして10尾の標本を得ると
  - ( 2, 3, 3, 4, 4, 4, 4, 5, 5, 6 ) だった

### 3. 仮定を置くということ

- 統計学では、「母集団分布を（計算によって簡単に確率が計算できる）良く知られた分布モデルに従う」と仮定することが多い
- 計算によって確率が簡単に計算でき、実際のデータと対応している分布
  - 正規分布
  - ……


## Chapter 6. 確率質量関数と確率密度関数

### 1. 【用語】確率質量関数

- データを入力すると、確率が出力されるような関数

### 2. 【用語】確率密度

- 連続型変数に対応した確率と考える

### 3. 【補足】積分と足し算の関係

skip

### 4. 【用語】確率密度関数

- データを入力すると、確率密度が出力されるような関数

### 5. 【用語】正規分布

- 正規分布の特徴
  - -∞～+∞
  - 平均値の近くにデータが集まりやすい
  - 平均値から離れる程、確率密度が小さくなる
  - 確率密度の大きさは、平均値を中心として左右対称

### 6. 【用語】母数（確率分布のパラメタ）

- 母数とは、確率分布を特徴つける値のこと
- 正規分布の母数は、平均（期待値）μと分散σ^2
- <font color=red>注意：サンプルサイズのことを母数と言わないこと</font>

### 7. 【補足】さまざまな確率分布

- 正規分布
- 二項分布
  - コインの裏表など「2パターンの結果しか発生しないデータ」に適用
- ポアソン分布
  - 個数や回数など「0以上の整数しかとらないデータ」に適用
- <font color=red>**重要事項**</font>
  - 統計分析では、母集団分布に、正規分布や二項分布などの良く知られた分布を適用することがしばしばある
  - 分布の形を（ある程度決め打ちで）仮定しないと、分析を進めることが難しい
  - しかし、誤った分布を仮定してしまうと、現実と大きく乖離した分析をしてしまう

### 8. 母集団分布の推定＝分布の決定＋母数の推定

- 母集団の分布を推定するとは以下の2つの作業で達成できる
  - ①分布の形を決める
  - ②母数（確率分布のパラメタ）を決める
- 今後母数を計算する上で、「なぜこの計算をしないといけないのか？」を理解しておくことが重要

### 9.  標本の統計量を母数の推定値だと考える

- **母数を推定する最も簡単なアイデア**
  - 「標本の統計量を、母集団分布の母数だと考えること」
- この場合
  - 母集団分布の母数を推定する作業は
    - 標本を抽出する
    - 標本の統計量を算出する＝これがそのまま母集団分布の母数（END）
    - 正規分布N(x|μ,σ) とすれば、平均と分散を求めるだけで、確率密度関数が求まる

### 10. 【補足】推定誤差

- 「標本の統計量を、母集団分布の母数と考える」アイデアとしては間違ってない
- ただし、標本の統計量と母数には、少しズレがあることが普通である
- **推定された母数には、推定誤差がある** ことを認めなければならない
- 推定誤差を加味した母数の推定
  - 点推定
  - 区間推定
- **推定誤差がある中で、それでも「主張したいこと」がある** 場合は **統計的仮説検定** を用いる
- これらは「推測統計学の応用」と位置づけ、第三部で学ぶ

### 11. まとめ：統計学の基本

skip


## Chapter 7. 統計量の計算

### 1. なぜ数式で表現するのか

skip

### 2. 【表記】標本

サンプルサイズをNとしたとき、標本は

$$
\{x_i\}_{i=1}^N = \{x_1, x_2, ... x_N\}
$$

### 3. 【表記】平均値

標本の平均値μは（一般には算術平均）

$$
\mu = \frac{1}{N}\sum_{i=1}^{N} x_i
$$

### 4. 【表記】期待値

離散型変数の場合、期待値μは「確率×その時の値」の合計値

$$
\mu = \sum_{i=1}^{N} P(x_i) \cdot x_i
$$

### 5. 【用語】母平均・標本平均

- 母平均は母集団の平均値、標本平均は標本の平均値
- 母平均は推定対象だが、わからないので標本平均で代用する
- 母平均と標本平均は少しずれていることが普通だが、**偏りはない**
- 言い換えると、プラスのズレとマイナスのズレがほぼ半々で起こりうる、ということ
- サンプルサイズを増やすと、標本平均はだんだん母平均に近づいていく

### 6. 【表記】分散（標本分散）

$$
\sigma^2 = \frac{1}{N} \sum_{i=1}^{N} (x_i - \mu)^2
$$

$$
(x_i - \mu)
$$

を**偏差**と呼ぶ

$$
\sum (x_i - \mu)^2
$$

を**偏差平方和**という

確率P(x)を使うと、

$$
\sigma^2 = \sum_{i=1}^{N} P(x_i) \cdot (x_i - \mu)^2
$$

とも表現できる
正確には標本分散という。

### 7. 【用語】分散（不偏分散）

- 標本分散だと母分散と比べて、分散を過小評価してしまうというバイアスがある
- 言い換えると、「母分散は標本分散より少し大きい」
- このバイアスを修正するのが、不偏分散である

不偏分散の計算式は、

$$
\sigma^2 = \frac{1}{N-1} \sum_{i=1}^{N} (x_i - \mu)^2
$$

### 8. 標本分散が偏りを持つ理由

skip

### 9. 【用語】標準偏差

- 分散の平方根をとったもの。不偏分散をの平方根をとるのが普通
- 数式は略
- 2乗して平方根をとるなら、はじめから絶対値にすればよいのでは？という疑問が浮かぶが
- 以下の理由により、それは推奨されない
  - 絶対値は、四則演算だけでできないので計算が複雑
  - 絶対値は、微分不可能ので最大最小が分かりづらい

## Chapter 8. 確率論の基本

- 確率の公理主義的定理
  - 以下の三つの公理を満たすものが確率である
    - ①すべての事象Aに対して 0≦P(A)≦1
    - ②P(Ω)=1 ※Ωは標本空間
    - ③排反な事象 A1,A2,...に対して、「A1...の各確率の和＝A1...の全和集合の確率」
- 頻度による確率の解釈
  - 頻度主義：確率は相対度数の極限値と考える
    - サイコロの1つの目が出る確率1/6とは、「無限回繰り返すと相対度数が1/6に収束する」という意味
    - **注意**：古典的な統計的推定ではよくこの立場を使う（分析の為の方法論やツールが整備されているから）
    - **注意**：解釈はしづらい。統計的仮説検定の信頼区間やp値という用語において、誤解が発生しやすい
  - ベイズ主義：個人が主観的に確率を割り当てる
    - 本書の対象外。ベイズ統計を学ぶ必要がある
- 確率の加法定理
  - 事象Aと事象Bが排反でない場合（一般）
    - Aの確率+Bの確率-AかつBの確率
  - 事象Aと事象Bが排反である場合（特殊）
    - Aの確率+Bの確率
- 条件付確率
  - 事象Bが起こった上で、事象Aが起こる確率
  - P(A|B) = P(A and B) / P(B)
- 確率の乗法定理
  - 条件付き確率の定義式から乗法定理が導かれる
  - P(A and B) = P(B) * P(A|B)
- 独立
  - P(A and B) = P(A) * P(B) が成り立つ時ABは独立という
  - あるいはP(A|B) = P(A)
    - B事象が起きようが起きまいがA事象が起きる確率は変わらないということ
  - 例：以下は独立である
    - A：偶数の目が出る, B：3の倍数の目が出る
    - A：1~3の目が出る, B：4~6の目が出る

## Chapter 9. 確率変数と確率分布



